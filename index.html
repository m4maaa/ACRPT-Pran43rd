<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>เกณฑ์การทดสอบสมรรถภาพร่างกาย 2569</title>

<style>
/* ===============================
   Base Layout
=============================== */
body{
  font-family:"Segoe UI",Tahoma,sans-serif;
  background:linear-gradient(135deg,#dff3e6,#cce8d8);
  min-height:100vh;
  padding:20px;
}
.card{
  max-width:900px;
  margin:auto;
  padding:22px;
  border-radius:16px;
  background:rgba(255,255,255,.75);
  backdrop-filter:blur(8px);
  box-shadow:0 8px 24px rgba(0,0,0,.15);
}

/* ===============================
   Table (Result)
=============================== */
table{
  width:100%;
  margin-top:18px;
  border-collapse:collapse;
  background:#fff;
  border-radius:10px;
  overflow:hidden;
}
th,td{
  border:1px solid #ccc;
  padding:8px;
  text-align:center;
  white-space:nowrap;
  font-size:14px;
}
th{background:#c8e6c9}

.fail  {background:#fdecea}
.p70   {background:#e8f5e9}
.p80   {background:#e3f2fd}
.p90   {background:#f3e5f5}
.p100  {background:#c8e6c9;font-size:15px}

/* ===============================
   Picker (Station / Age)
=============================== */
.picker{
  position:relative;
  height:150px;
  overflow-y:auto;
  scroll-snap-type:y mandatory;
  border-radius:14px;
  background:linear-gradient(#f8fff9,#e3f3e8);
  border:1px solid #a5d6a7;
  cursor:grab;
}
.picker.dragging{cursor:grabbing}
.picker::-webkit-scrollbar{display:none}

.picker-item,
.picker-spacer{
  height:50px;
  display:flex;
  align-items:center;
  justify-content:center;
  scroll-snap-align:center;
}
.picker-item{
  font-size:16px;
  color:#777;
  user-select:none;
}
.picker-item.active{
  color:#1b5e20;
  font-weight:700;
  background:rgba(255,255,255,.9);
  border-radius:10px;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.8),
    0 4px 12px rgba(0,0,0,.15);
}

/* Center highlight (Vista style) */
.picker::before,
.picker::after{
  content:"";
  position:absolute;
  left:0;right:0;
  height:50px;
  pointer-events:none;
}
.picker::before{
  top:0;
  background:linear-gradient(to bottom,#e3f3e8,transparent);
}
.picker::after{
  bottom:0;
  background:linear-gradient(to top,#e3f3e8,transparent);
}

/* ===============================
   Alert
=============================== */
.alert{
  margin-top:18px;
  padding:14px;
  border-radius:10px;
  text-align:center;
  font-weight:700;
}
.alert-error{
  color:#b71c1c;
  background:#fdecea;
  border:1px solid #f5c6cb;
}

</style>
</head>

<body>
<div class="card">

  <!-- Picker สถานี (ไม่มี label) -->
<div class="picker" id="stationPicker">
  <div class="picker-spacer"></div>

  <div class="picker-item" data-value="s1">สถานีที่ 1 งอเข่าครึ่งนั่ง ยกบาร์น้ำหนัก</div>
  <div class="picker-item" data-value="s2">สถานีที่ 2 ย่อตัวทุ่มน้ำหนักไปด้านหลัง</div>
  <div class="picker-item" data-value="s3">สถานีที่ 3 ดันพื้นละมือกางแขน</div>
  <div class="picker-item" data-value="s4">สถานีที่ 4 วิ่งไป-กลับ ลากและยกสิ่งของ</div>
  <div class="picker-item" data-value="s5">สถานีที่ 5 กระดานคว่ำ</div>
  <div class="picker-item" data-value="s6">สถานีที่ 6 วิ่ง 2 กิโลเมตร</div>

  <!-- spacer ล่าง -->
  <div class="picker-spacer"></div>

</div>

<!-- ค่าที่เลือกจริง (ซ่อน) -->
<input type="hidden" id="station" value="s1">

<label>อายุผู้เข้ารับการทดสอบ</label>

<div style="display:flex; gap:10px;">
  <!-- หลักสิบ -->
  <div class="picker" id="ageTensPicker" style="flex:1;">
    <div class="picker-spacer"></div>
    <div class="picker-item" data-value="1">1</div>
    <div class="picker-item" data-value="2">2</div>
    <div class="picker-item" data-value="3">3</div>
    <div class="picker-item" data-value="4">4</div>
    <div class="picker-item" data-value="5">5</div>
    <div class="picker-item" data-value="6">6</div>
    <div class="picker-spacer"></div>
  </div>

  <!-- หลักหน่วย -->
  <div class="picker" id="ageOnesPicker" style="flex:1;">
    <div class="picker-spacer"></div>
    <div class="picker-item" data-value="0">0</div>
    <div class="picker-item" data-value="1">1</div>
    <div class="picker-item" data-value="2">2</div>
    <div class="picker-item" data-value="3">3</div>
    <div class="picker-item" data-value="4">4</div>
    <div class="picker-item" data-value="5">5</div>
    <div class="picker-item" data-value="6">6</div>
    <div class="picker-item" data-value="7">7</div>
    <div class="picker-item" data-value="8">8</div>
    <div class="picker-item" data-value="9">9</div>
    <div class="picker-spacer"></div>
  </div>
</div>

<input type="hidden" id="age" value="">
<div id="summary" style="
  text-align:center;
  font-size:14px;
  color:#555;
  margin-top:10px;
"></div>

<div id="result"></div>
<button id="resetBtn" style="
  position:fixed;
  right:16px;
  bottom:16px;
  padding:10px 14px;
  border-radius:50%;
  border:none;
  background:#4caf50;
  color:white;
  font-size:14px;
">
↺
</button>
<link rel="manifest" href="manifest.json">

</div>

<script>
/* ==================================================
   1) Utilities
================================================== */
function enableMouseDrag(p){
  let down=false,y,s;
  p.addEventListener("mousedown",e=>{
    down=true;p.classList.add("dragging");
    y=e.pageY-p.offsetTop;s=p.scrollTop;
  });
  ["mouseup","mouseleave"].forEach(ev=>{
    document.addEventListener(ev,()=>{down=false;p.classList.remove("dragging");});
  });
  p.addEventListener("mousemove",e=>{
    if(!down)return;
    e.preventDefault();
    p.scrollTop=s-(e.pageY-p.offsetTop-y);
  });
}

function snapToActive(picker, items){
  const a = items.find(i=>i.classList.contains("active"));
  if(a){
    picker.scrollTop =
      a.offsetTop - picker.clientHeight/2 + a.offsetHeight/2;
  }
}

/* ==================================================
   2) Constants / State
================================================== */
const ageGroups=[
 [17,21],[22,26],[27,31],[32,36],
 [37,41],[42,46],[47,51],[52,60]
];

const hiddenAge=document.getElementById("age");
const hiddenStation=document.getElementById("station");
const result=document.getElementById("result");
const summary=document.getElementById("summary");

/* ===== data s1–s6 (ของคุณเดิม) ===== */
const data={
/* ===== สถานี 1 ===== */
s1:{unit:"น้ำหนัก",values:{
"ไม่ผ่านเกณฑ์":["มากกว่า 75","มากกว่า 61","มากกว่า 67","มากกว่า 63","มากกว่า 59","มากกว่า 55","มากกว่า 51","มากกว่า 47"],
"เกณฑ์ผ่าน 70%":["75 – 91","71 – 87","67 – 83","63 – 79","59 – 75","55 – 71","51 – 67","47 – 63"],
"เกณฑ์ผ่าน 80%":["95 – 111","91 – 107","87 – 103","83 – 99","79 – 95","75 – 91","71 – 87","67 – 83"],
"เกณฑ์ผ่าน 90%":["115 – 131","111 – 127","107 – 123","103 – 119","99 – 115","95 – 111","91 – 107","87 – 107"],
"เกณฑ์ผ่าน 100%":["น้อยกว่า 135","น้อยกว่า 131","น้อยกว่า 124","น้อยกว่า 123","น้อยกว่า 119","น้อยกว่า 115","น้อยกว่า 111","น้อยกว่า 107"]
}},
/* ===== สถานี 2 ===== */
s2:{unit:"เมตร",values:{
"ไม่ผ่านเกณฑ์":["มากกว่า 7.2","มากกว่า 7.2","มากกว่า 7.1","มากกว่า 6.9","มากกว่า 6.7","มากกว่า 6.5","มากกว่า 6.3","มากกว่า 6.1"],
"เกณฑ์ผ่าน 70%":["7.2 – 8.6","7.2 – 8.6","7.1 – 8.5","6.9 – 8.3","6.7 – 8.1","6.5 – 7.9","6.3 – 7.7","6.1 – 7.5"],
"เกณฑ์ผ่าน 80%":["8.7 – 10.1","8.7 – 10.1","8.6 – 10","8.4 – 9.5","8.2 – 9.5","8 – 9.4","7.8 – 9.2","7.6 – 9"],
"เกณฑ์ผ่าน 90%":["10.2 – 11.6","10.2 – 11.6","10.1 – 11.5","9.5 – 11.3","9.3 – 11.1","9.1 – 11","8.9 – 10.7","8.8 – 10.5"],
"เกณฑ์ผ่าน 100%":["น้อยกว่า 11.7","น้อยกว่า 11.7","น้อยกว่า 11.6","น้อยกว่า 11.4","น้อยกว่า 11.2","น้อยกว่า 11","น้อยกว่า 10.8","น้อยกว่า 10.6"]
}},
/* ===== สถานี 3 ===== */
s3:{unit:"ครั้ง",values:{
"ไม่ผ่านเกณฑ์":["มากกว่า 30","มากกว่า 30","มากกว่า 29","มากกว่า 27","มากกว่า 25","มากกว่า 23","มากกว่า 21","มากกว่า 19"],
"เกณฑ์ผ่าน 70%":["30 – 39","30 – 39","29 – 38","27 – 36","25 – 34","23 – 32","21 – 30","19 – 28"],
"เกณฑ์ผ่าน 80%":["40 – 49","40 – 49","39 – 48","37 – 46","35 – 44","33 – 42","31 – 40","29 – 38"],
"เกณฑ์ผ่าน 90%":["50 – 59","50 – 59","49 – 58","47 – 56","45 – 54","43 – 52","41 – 49","39 – 48"],
"เกณฑ์ผ่าน 100%":["น้อยกว่า 60","น้อยกว่า 60","น้อยกว่า 59","น้อยกว่า 57","น้อยกว่า 55","น้อยกว่า 53","น้อยกว่า 51","น้อยกว่า 49"]
}},
/* ===== สถานี 4 ===== */
s4:{unit:"เวลา",values:{
"ไม่ผ่านเกณฑ์":["มากกว่า 2.10","มากกว่า 2.14","มากกว่า 2.18","มากกว่า 2.22","มากกว่า 2.26","มากกว่า 2.30","มากกว่า 2.34","มากกว่า 2.36"],
"เกณฑ์ผ่าน 70%":["2.10 – 2.01","2.14 – 2.05","2.18 – 2.09","2.22 – 2.13","2.26 – 2.17","2.30 – 2.21","2.34 – 2.25","2.36 – 2.27"],
"เกณฑ์ผ่าน 80%":["1.51 – 2.00","1.55 – 2.04","1.59 – 2.08","2.03 – 2.12","2.25 – 2.16","2.29 – 2.20","2.33 – 2.24","2.35 – 2.26"],
"เกณฑ์ผ่าน 90%":["1.59 – 1.50","2.03 – 1.54","2.07 – 1.58","2.11 – 2.02","2.15 – 2.06","2.19 – 2.10","2.23 – 2.14","2.25 – 2.16"],
"เกณฑ์ผ่าน 100%":["น้อยกว่า 1.33","น้อยกว่า 1.37","น้อยกว่า 1.41","น้อยกว่า 1.45","น้อยกว่า 1.49","น้อยกว่า 1.53","น้อยกว่า 1.57","น้อยกว่า 1.59"]
}},
/* ===== สถานี 5 ===== */
s5:{unit:"เวลา",values:{
"ไม่ผ่านเกณฑ์":["น้อยกว่า 2.02","น้อยกว่า 1.57","น้อยกว่า 1.52","น้อยกว่า 1.47","น้อยกว่า 1.42","น้อยกว่า 1.42","น้อยกว่า 1.42","น้อยกว่า 1.42"],
"เกณฑ์ผ่าน 70%":["2.02 – 2.34","1.57 – 2.29","1.52 – 2.24","1.47 – 2.19","1.42 – 2.14","1.42 – 2.14","1.42 – 2.14","1.42 – 2.14"],
"เกณฑ์ผ่าน 80%":["2.35 – 3.06","2.30 – 3.01","2.25 – 2.56","2.20 – 2.51","2.15 – 2.46","2.15 – 2.46","2.15 – 2.46","2.15 – 2.46"],
"เกณฑ์ผ่าน 90%":["3.07 – 3.39","3.02 – 3.34","2.57 – 3.30","2.52 – 3.25","2.47 – 3.19","2.47 – 3.19","2.47 – 3.19","2.47 – 3.19"],
"เกณฑ์ผ่าน 100%":["มากกว่า 3.40","มากกว่า 3.35","มากกว่า 3.30","มากกว่า 3.25","มากกว่า 3.20","มากกว่า 3.20","มากกว่า 3.20","มากกว่า 3.20"]
}},
/* ===== สถานี 6 ===== */
s6:{unit:"เวลา",values:{
"ไม่ผ่านเกณฑ์":["มากกว่า 9.20","มากกว่า 9.45","มากกว่า 10.15","มากกว่า 10.45","มากกว่า 11.20","มากกว่า 11.55","มากกว่า 12.30","มากกว่า 13.05"],
"เกณฑ์ผ่าน 70%":["9.20 – 8.29","9.45 – 8.54","10.15 – 9.24","10.45 – 9.54","11.20 – 10.29","11.55 – 11.04","12.30 – 11.39","13.05 – 12.14"],
"เกณฑ์ผ่าน 80%":["8.30 – 7.39","8.55 – 8.04","9.25 – 8.34","9.55 – 9.04","10.30 – 9.39","11.05 – 10.14","11.40 – 10.49","12.15 – 11.24"],
"เกณฑ์ผ่าน 90%":["7.40 – 6.49","8.05 – 7.14","8.35 – 7.44","9.05 – 8.14","9.40 – 8.49","10.15 – 9.24","10.50 – 9.59","11.25 – 10.34"],
"เกณฑ์ผ่าน 100%":["น้อยกว่า 6.50","น้อยกว่า 7.15","น้อยกว่า 7.45","น้อยกว่า 8.15","น้อยกว่า 8.50","น้อยกว่า 9.25","น้อยกว่า 10.00","น้อยกว่า 10.35"]
}}
};

/* ==================================================
   3) Render (ตัวเดียวเท่านั้น)
================================================== */
function render(){
  const age=+hiddenAge.value;
  const st=hiddenStation.value;

  if(!age || !st || !data[st]){
    result.innerHTML="";
    return;
  }

  const idx=ageGroups.findIndex(g=>age>=g[0]&&age<=g[1]);
  if(idx<0){
    result.innerHTML="";
    return;
  }

  summary.textContent =
    `สถานี ${st.replace("s","")} • อายุ ${age} ปี`;

  let html=`<table>
    <tr><th>เปอร์เซ็นต์ผ่านเกณฑ์</th><th>จำนวน/เวลา</th></tr>`;

  for(const k in data[st].values){
    const cls=
      k==="ไม่ผ่านเกณฑ์"?"fail":
      k==="เกณฑ์ผ่าน 70%"?"p70":
      k==="เกณฑ์ผ่าน 80%"?"p80":
      k==="เกณฑ์ผ่าน 90%"?"p90":"p100";

    html+=`<tr>
      <td class="${cls}">${k}</td>
      <td>${data[st].values[k][idx]}</td>
    </tr>`;
  }

  result.innerHTML=html+"</table>";
}

/* ==================================================
   4) Station Picker
================================================== */
const sp=document.getElementById("stationPicker");
const sItems=[...sp.querySelectorAll(".picker-item")];

function syncStation(){
  const c=sp.scrollTop+sp.clientHeight/2;
  sItems.forEach(i=>{
    if(Math.abs(c-(i.offsetTop+i.offsetHeight/2))<i.offsetHeight/2){
      sItems.forEach(x=>x.classList.remove("active"));
      i.classList.add("active");
      hiddenStation.value=i.dataset.value;
      render();
      setTimeout(()=>snapToActive(sp,sItems),60);
    }
  });
}

sp.addEventListener("scroll",()=>requestAnimationFrame(syncStation));
sItems[0].classList.add("active");
hiddenStation.value=sItems[0].dataset.value;
enableMouseDrag(sp);

/* ==================================================
   5) Age Picker (2 Columns + Lock 17–60)
================================================== */
const tensP=document.getElementById("ageTensPicker");
const onesP=document.getElementById("ageOnesPicker");
const tens=[...tensP.querySelectorAll(".picker-item")];
const ones=[...onesP.querySelectorAll(".picker-item")];

let t=1,o=7;

function scrollTo(p,items,val){
  const it=items.find(x=>+x.dataset.value===val);
  if(it){
    p.scrollTop=it.offsetTop-p.clientHeight/2+it.offsetHeight/2;
  }
}

function lockOnes(lock){
  ones.forEach(i=>{
    if(lock && i.dataset.value!=="0"){
      i.style.opacity="0.3";
      i.style.pointerEvents="none";
    }else{
      i.style.opacity="";
      i.style.pointerEvents="";
    }
  });
}

function updateAge(){
  if(t===1 && o<7){ o=7; scrollTo(onesP,ones,7); }
  if(t===6){ o=0; scrollTo(onesP,ones,0); lockOnes(true); }
  else{ lockOnes(false); }

  hiddenAge.value=t*10+o;
  render();
}

function syncAge(p,items,set){
  const c=p.scrollTop+p.clientHeight/2;
  items.forEach(i=>{
    if(Math.abs(c-(i.offsetTop+i.offsetHeight/2))<i.offsetHeight/2){
      items.forEach(x=>x.classList.remove("active"));
      i.classList.add("active");
      set(+i.dataset.value);
      updateAge();
      setTimeout(()=>snapToActive(p,items),60);
    }
  });
}

tensP.addEventListener("scroll",()=>requestAnimationFrame(()=>syncAge(tensP,tens,v=>t=v)));
onesP.addEventListener("scroll",()=>requestAnimationFrame(()=>syncAge(onesP,ones,v=>o=v)));

tens[0].classList.add("active");
ones[7].classList.add("active");
hiddenAge.value=17;
render();

enableMouseDrag(tensP);
enableMouseDrag(onesP);

/* ==================================================
   6) Optional Enhancements
================================================== */
if("serviceWorker" in navigator){
  navigator.serviceWorker.register("sw.js");
}
/* ===============================
   Reset Button
=============================== */
const resetBtn = document.getElementById("resetBtn");

resetBtn.addEventListener("click", () => {

  /* ===== reset สถานี ===== */
  const firstStation = sItems[0];
  sItems.forEach(i => i.classList.remove("active"));
  firstStation.classList.add("active");
  hiddenStation.value = firstStation.dataset.value;
  sp.scrollTop =
    firstStation.offsetTop - sp.clientHeight/2 + firstStation.offsetHeight/2;

  /* ===== reset อายุ = 17 ===== */
  t = 1;
  o = 7;
  hiddenAge.value = 17;

  tens.forEach(i => i.classList.remove("active"));
  ones.forEach(i => i.classList.remove("active"));
  tens[0].classList.add("active");
  ones[7].classList.add("active");

  scrollTo(tensP, tens, 1);
  scrollTo(onesP, ones, 7);
  lockOnes(false);

  /* ===== reset ผลลัพธ์ ===== */
  result.innerHTML = "";
  render();
});

</script>

</body>
</html>
